---

- name: test graylog roles
  hosts: localhost
  become: false
  gather_facts: false
  vars:
    username: admin
    password: testpass
    endpoint: http://localhost:9000

  tasks:

    - name: create Admin role
      graylog_roles:
        endpoint: "{{ endpoint }}"
        graylog_user: "{{ username }}"
        graylog_password: "{{ password }}"
        state: present
        name: testdude
        description: wat
        permissions: ['sreams:read:*']
      register: role_1

    - name: check roles
      assert:
        that:
          - role_1.changed
