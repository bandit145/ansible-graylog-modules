---

- name: test graylog roles
  hosts: localhost
  become: false
  gather_facts: false
  vars:
    username: admin
    password: testpass
    endpoint: http://localhost:9000

  tasks:

    - name: get roles
      graylog_roles:
        endpoint: "{{ endpoint }}"
        graylog_user: "{{ username }}"
        graylog_password: "{{ password }}"
        action: list
      register: roles_1

    - name: check roles
      assert:
        that:
          - roles_1.roles | length == 5
          - roles_1.roles.
